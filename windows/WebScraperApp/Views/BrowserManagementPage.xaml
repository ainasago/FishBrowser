<Page x:Class="FishBrowser.WPF.Views.BrowserManagementPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="æµè§ˆå™¨ç®¡ç†">
  <Grid Margin="10">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="260"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- å·¦ä¾§ï¼šåˆ†ç»„åˆ—è¡¨ -->
    <GroupBox Grid.Column="0" Header="åˆ†ç»„" Margin="0,0,8,0">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="*"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <ListBox x:Name="GroupList" Grid.Row="0" SelectionChanged="GroupList_SelectionChanged" DisplayMemberPath="Name"/>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,0">
          <Button Content="æ–°å»ºåˆ†ç»„" Width="80" Click="NewGroup_Click"/>
          <Button Content="ç¼–è¾‘" Width="60" Margin="6,0,0,0" Click="EditGroup_Click"/>
          <Button Content="åˆ é™¤" Width="60" Margin="6,0,0,0" Click="DeleteGroup_Click"/>
        </StackPanel>
      </Grid>
    </GroupBox>

    <!-- å³ä¾§ï¼šæµè§ˆå™¨åˆ—è¡¨ -->
    <GroupBox Grid.Column="1" Header="æµè§ˆå™¨çŽ¯å¢ƒ">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <TextBlock x:Name="GroupTitle" Grid.Row="0" Text="å…¨éƒ¨æµè§ˆå™¨" FontWeight="Bold" Margin="0,0,0,6"/>
        <DataGrid x:Name="EnvironmentGrid" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single">
          <DataGrid.Columns>
            <DataGridTextColumn Header="åç§°" Binding="{Binding Name}" Width="140"/>
            <DataGridTextColumn Header="æŒ‡çº¹é…ç½®" Binding="{Binding FingerprintProfile.Name}" Width="120"/>
            <DataGridTextColumn Header="UA" Binding="{Binding FingerprintProfile.UserAgent}" Width="180"/>
            <DataGridTextColumn Header="æ›´æ–°æ—¶é—´" Binding="{Binding FingerprintProfile.UpdatedAt, StringFormat=yyyy-MM-dd HH:mm}" Width="130"/>
            <DataGridTextColumn Header="å¼•æ“Ž" Binding="{Binding Engine}" Width="60"/>
            <DataGridTextColumn Header="OS" Binding="{Binding OS}" Width="50"/>
            <DataGridTextColumn Header="å¯åŠ¨æ¬¡æ•°" Binding="{Binding LaunchCount}" Width="70"/>
            <DataGridCheckBoxColumn Header="æŒä¹…åŒ–" Binding="{Binding EnablePersistence}" Width="60" IsReadOnly="True"/>
          </DataGrid.Columns>
        </DataGrid>
        <StackPanel Grid.Row="2" Margin="0,8,0,0">
          <!-- ç¬¬ä¸€è¡Œï¼šåŸºæœ¬æ“ä½œ -->
          <StackPanel Orientation="Horizontal">
            <Button Content="æ–°å»ºæµè§ˆå™¨" Width="100" Click="NewEnvironment_Click"/>
            <Button Content="ç¼–è¾‘" Width="60" Margin="8,0,0,0" Click="EditEnvironment_Click"/>
            <Button Content="åˆ é™¤" Width="60" Margin="8,0,0,0" Click="DeleteEnvironment_Click"/>
            <Button Content="å¯åŠ¨" Width="60" Margin="8,0,0,0" Click="LaunchEnvironment_Click"/>
            <Button Content="æ›´æ¢æŒ‡çº¹é…ç½®" Width="100" Margin="8,0,0,0" Click="ChangeProfile_Click"/>
            <Button Content="æ¸…é™¤ä¼šè¯" Width="80" Margin="8,0,0,0" Click="ClearSession_Click"/>
            <Button Content="ç§»åŠ¨åˆ°åˆ†ç»„" Width="100" Margin="8,0,0,0" Click="MoveEnvironment_Click"/>
          </StackPanel>
          
          <!-- ç¬¬äºŒè¡Œï¼šæ‰¹é‡æ“ä½œå’Œæµ‹è¯•å·¥å…· -->
          <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
            <Button Content="æ‰¹é‡åˆ‡æ¢ Profile" Width="120" Click="BatchChangeProfile_Click"/>
            <Separator Margin="8,0,8,0" Background="#DDD" Width="1"/>
            <Button Content="ðŸ” æŒ‡çº¹å¯¹æ¯”" Width="100" Margin="8,0,0,0" Click="CompareFingerprints_Click" Background="#4CAF50" Foreground="White" ToolTip="å¯¹æ¯”çœŸå®žæµè§ˆå™¨å’Œ Playwright çš„æ‰€æœ‰æŒ‡çº¹ç‰¹å¾"/>
            <Button Content="ðŸ›¡ï¸ Cloudflare æµ‹è¯•" Width="120" Margin="8,0,0,0" Click="LaunchMVP_Click" Background="#FF6B35" Foreground="White" ToolTip="å¯åŠ¨èƒ½é€šè¿‡ Cloudflare éªŒè¯çš„æµ‹è¯•æµè§ˆå™¨ï¼ˆå®Œæ•´é˜²æ£€æµ‹é…ç½®ï¼‰"/>
            <Button Content="ðŸ¦Š Firefox æµ‹è¯•" Width="100" Margin="8,0,0,0" Click="LaunchFirefox_Click" Background="#FF7139" Foreground="White" ToolTip="ä½¿ç”¨ Firefox æµ‹è¯•ï¼ˆå¯èƒ½ç»•è¿‡ TLS æ£€æµ‹ï¼‰"/>
            <Button Content="ðŸ¤– Undetected Chrome" Width="140" Margin="8,0,0,0" Click="LaunchUndetectedChrome_Click" Background="#4285F4" Foreground="White" ToolTip="ä½¿ç”¨ Selenium + UndetectedChromeDriverï¼ˆçœŸå®ž TLS æŒ‡çº¹ï¼ŒæˆåŠŸçŽ‡ 90-95%ï¼‰"/>
          </StackPanel>
          
          <!-- ç¬¬ä¸‰è¡Œï¼šæ‰©å±•é€‰é¡¹ -->
          <CheckBox x:Name="LoadAutomaCheckBox" 
                    Content="å¯åŠ¨æ—¶åŠ è½½ Automa è‡ªåŠ¨åŒ–æ‰©å±•ï¼ˆå¯è§†åŒ–å·¥ä½œæµï¼‰" 
                    IsChecked="False"
                    Margin="0,8,0,0"
                    ToolTip="åŠ è½½ Automa æµè§ˆå™¨è‡ªåŠ¨åŒ–æ‰©å±•ï¼Œæä¾›å¯è§†åŒ–å·¥ä½œæµç¼–è¾‘ã€è¡¨å•å¡«å……ã€æ•°æ®æŠ“å–ç­‰åŠŸèƒ½ã€‚å¿«æ·é”®ï¼šAlt+A æ‰“å¼€ä»ªè¡¨æ¿ï¼ŒAlt+P æ‰“å¼€å…ƒç´ é€‰æ‹©å™¨"/>
        </StackPanel>
      </Grid>
    </GroupBox>

    <!-- åº•éƒ¨çŠ¶æ€æ  -->
    <TextBlock x:Name="StatusText" Grid.Row="1" Grid.ColumnSpan="2" Margin="0,8,0,0" VerticalAlignment="Center"/>
  </Grid>
</Page>
