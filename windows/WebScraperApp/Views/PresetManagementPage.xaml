<Page x:Class="FishBrowser.WPF.Views.PresetManagementPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="预设管理">
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- 工具栏 -->
    <DockPanel Grid.Row="0" Margin="10">
      <Button Content="新建" Width="80" Click="NewPreset_Click"/>
      <Button Content="编辑" Width="80" Margin="8,0,0,0" Click="EditPreset_Click"/>
      <Button Content="删除" Width="80" Margin="8,0,0,0" Click="DeletePreset_Click"/>
      <Button Content="复制" Width="80" Margin="8,0,0,0" Click="DuplicatePreset_Click"/>
      <Separator Width="16" Opacity="0"/>
      <Button Content="差异对比" Width="100" Margin="8,0,0,0" Click="DiffPreset_Click"/>
      <Button Content="导出为 JSON" Width="120" Margin="8,0,0,0" Click="ExportPreset_Click"/>
      <Button Content="导入 JSON" Width="120" Margin="8,0,0,0" Click="ImportPreset_Click"/>
      <TextBox x:Name="SearchBox" Width="200" Margin="20,0,0,0"/>
    </DockPanel>

    <!-- 列表与详情 -->
    <Grid Grid.Row="1" Margin="10">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="350"/>
        <ColumnDefinition Width="10"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <!-- 预设列表 -->
      <DataGrid x:Name="PresetGrid" Grid.Column="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionChanged="PresetGrid_SelectionChanged">
        <DataGrid.Columns>
          <DataGridTextColumn Header="名称" Binding="{Binding Name}" Width="*"/>
          <DataGridTextColumn Header="版本" Binding="{Binding Version}" Width="80"/>
        </DataGrid.Columns>
      </DataGrid>

      <!-- 详情面板 -->
      <GroupBox Header="详情" Grid.Column="2" Margin="10,0,0,0">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <StackPanel Orientation="Horizontal" Margin="6,4,6,4">
            <TextBlock Text="名称:" FontWeight="Bold" Width="80"/>
            <TextBox x:Name="NameBox" Width="300"/>
          </StackPanel>

          <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="6,4,6,4">
            <TextBlock Text="描述:" FontWeight="Bold" Width="80"/>
            <TextBox x:Name="DescBox" Width="300"/>
          </StackPanel>

          <StackPanel Orientation="Horizontal" Grid.Row="2" Margin="6,4,6,4">
            <TextBlock Text="标签:" FontWeight="Bold" Width="80"/>
            <Grid Width="300">
              <TextBlock Text="逗号分隔" Foreground="Gray" Margin="5,0,0,0" VerticalAlignment="Center" x:Name="TagsPlaceholderText" Visibility="Visible"/>
              <TextBox x:Name="TagsBox" Background="Transparent" TextChanged="TagsBox_TextChanged"/>
            </Grid>
          </StackPanel>

          <GroupBox Header="Traits JSON" Grid.Row="3" Margin="6,8,6,6">
            <TextBox x:Name="TraitsBox" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" FontFamily="Courier New" FontSize="11"/>
          </GroupBox>
        </Grid>
      </GroupBox>
    </Grid>

    <!-- 状态栏 -->
    <DockPanel Grid.Row="2" Margin="10">
      <TextBlock x:Name="StatusText"/>
      <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
        <Button Content="保存" Width="80" Margin="0,0,8,0" Click="SavePreset_Click"/>
      </StackPanel>
    </DockPanel>
  </Grid>
</Page>